"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-popup-message")+e.resolveComponent("uni-popup")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms")+e.resolveComponent("uni-card"))()}Math||((()=>"../../uni_modules/uni-popup/components/uni-popup-message/uni-popup-message.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js")+(()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js")+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const o={__name:"me",setup(o){let n=e.ref(""),s=e.ref("");const u=e.ref(null);let a=e.ref({account:"admin",password:"123456"}),i=e.ref({}),t=e.ref(),l=e.ref();const r=e=>{console.log(e.detail),t.value=e.detail.avatarUrl},p=()=>{e.index.login({provider:"weixin",onlyAuthorize:!0,success:function(o){const{code:a}=o;console.log("code:",a),e.index.request({url:"https://api.suxin23.cn/weixinlogin/login",method:"POST",data:{code:a},success:o=>{i.value=o.data,200===o.data.code&&(n.value="success",s.value="登陆成功",u.value.open(),i.value=o.data,setTimeout((()=>{e.index.request({url:"https://api.suxin23.cn/weixinlogin/verify",data:{openid:o.data.data.openid,session_key:o.data.data.session_key},success:e=>{i.value=e.data,200===e.data.code&&(n.value="success",s.value=e.data.msg,u.value.open(),i.value=e.data)}})}),3e3))}})},fail:function(e){}})},c=()=>{e.index.request({url:"https://api.suxin23.cn/admin/login",method:"POST",data:{account:a.value.account,password:a.value.password},success:e=>{console.log(e),200===e.data.code?(n.value="success",s.value="登陆成功",u.value.open(),i.value=e.data):(n.value="error",s.value="登录失败",u.value.open())},fail:e=>{console.error(e)}})};return(o,d)=>({a:e.p({type:e.unref(n),message:e.unref(s),duration:2e3}),b:e.sr(u,"11fcb8e0-0",{k:"message"}),c:e.p({type:"message"}),d:e.o((o=>e.unref(a).account=o)),e:e.p({placeholder:"请输入账号",modelValue:e.unref(a).account}),f:e.p({label:"账号:",required:!0}),g:e.o((o=>e.unref(a).password=o)),h:e.p({type:"password",placeholder:"请输入密码",modelValue:e.unref(a).password}),i:e.p({label:"密码:",required:!0}),j:e.o(c),k:e.o(p),l:e.unref(t),m:e.o(r),n:e.unref(l),o:e.o((o=>e.isRef(l)?l.value=o.detail.value:l=o.detail.value)),p:e.sr("baseForm","11fcb8e0-3,11fcb8e0-2"),q:e.p({modelValue:e.unref(a),"label-position":"top"}),r:e.p({title:"登录"}),s:e.t(e.unref(i))})}};wx.createPage(o);
